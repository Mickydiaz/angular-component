<!doctype html>
<html>
  <head>
    <title>Angular .component()</title>
    <script src="angular-1.3.0.js"></script>
    <script src="dist/angular-component.js"></script>
  </head>
  <body>
    <div ng-app="app">
      <stateful-component></stateful-component>
    </div>
    <script>
      var statefulComponent = {
        template: `
          <div>
            {{ $ctrl.user }}
            <stateless-component
              user="$ctrl.user"
              attr="{{ $ctrl.user.name }}"
              on-update="$ctrl.updateUser($event);">
            </stateless-component>
          </div>
        `,
        controller: function () {
          this.user = {
            name: 'Todd',
            location: 'England, UK'
          };
          this.updateUser = function (event) {
            this.user = event.user;
          };
        }
      };

      var statelessComponent = {
        bindings: {
          user: '<',
          attr: '@',
          onUpdate: '&'
        },
        controller: function (EventEmitter) {
          this.$onChanges = function (changes) {
            if (changes.user) {
              this.user = angular.copy(this.user);
            }
          };
          this.save = function() {
            this.onUpdate(
              EventEmitter({
                user: this.user
              })
            );
          }
        },
        template: `
          <div>
            {{ $ctrl.attr }}
            <input type="text" ng-model="$ctrl.user.name">
            <a href="" ng-click="$ctrl.save()">Update</a>
          </div>
        `
      };

      angular
      .module('app', [])
      .component('statefulComponent', statefulComponent)
      .component('statelessComponent', statelessComponent)
      .value('EventEmitter', function (payload) {
        return {
          $event: payload
        };
      });
    </script>
  </body>
</html>
